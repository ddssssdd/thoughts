<% include head %>
<nav class="navbar navbar-inverse navbar-fixed-top">
	<div class="container">
		<div class="navbar-header">
			<a class="navbar-brand" href="/spiders/index">Home</a>
		</div>
		<div class="navbar-collapse collapse" role="navigation">
			<ul class="nav navbar-nav">
				<li>
					<a href="/spiders/add">Manage</a>
				</li>
				
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="/spiders/settings">Settings</a>
				</li>
			</ul>
		</div>
	</div>
</nav>
<div class="container">
<!-- <form class="form-horizontal" method="POST" action="add_book">
  <div class="form-group">
    <label for="inputEmail3" class="col-sm-2 control-label">Book Name</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" name="name" placeholder="Book Name">
    </div>
  </div>
  <div class="form-group">
    <label for="inputPassword3" class="col-sm-2 control-label">Url</label>
    <div class="col-sm-10">
      <input type="url" class="form-control" name="url" placeholder="Url">
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <div class="checkbox">
        <label>
          <input type="checkbox" name="do_now"> Download immediatly
        </label>
      </div>
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button type="submit" class="btn btn-default">Download</button>
    </div>
  </div>
</form>	 -->	
<div class="row">
	<div class="panel panel-default">
	<div class="panel-heading pull-center">
		<!-- Button trigger modal -->
		<div class="btn-group">
		<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
		  Add
		</button>
		</div>

		<!-- Modal -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="myModalLabel">Add Book To Library</h4>
		      </div>
		      <div class="modal-body">
		       <form method="POST" action="add_book" id="form_in_model">
		          <div class="form-group">
		            <label for="recipient-name" class="control-label">Name:</label>
		            <input type="text" class="form-control" name="name" placeholder="Book Name">
		          </div>
		          <div class="form-group">
		            <label for="message-text" class="control-label">Url:</label>
		            <input type="text" class="form-control" name ="url" placeholder="http://www.biquge.la/book/1/">
		          </div>
		        </form>
		       </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        <button type="button" class="btn btn-primary" onclick="$('#form_in_model').submit();">Add Book!</button>
		      </div>
		    </div>
		  </div>
		</div>
	</div>
	<table class="table table-striped table-hover table-bordered">
		<% books.forEach(function(b){ %>
			<tr>
				<td class="text-center"><a href="/spiders/read/<%= b.id %>"> <%= b.title %> </a></td>
				<td><%= b.url %> </td>
				<td><input type="checkbox" <%= b.in_scheduled?'checked':'' %> data-id='<%= b.id %>' onchange="update_book(this);"/> </td>
				<td><%= b.last_updated %></td>
			</tr>
		<% }) %>
	</table>
	</div>
</div>
</div>

<script>	
	function update_book(check){
		var check = $(check);
		var in_scheduled = check.is(":checked");
		console.log(check.data('id'));
		$.post("/spiders/update_book",{id:check.data("id"),in_scheduled:check.is(":checked")},function(json){
			console.log(json);
			//window.location.reload();
		})
	}
	
</script>
	
<% include footer %>
